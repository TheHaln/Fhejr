require('dotenv').config();
const Discord = require('discord.js');
const client = new Discord.Client();

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
const TOKEN = process.env.MTIzODYxMjI5MjkzMzc4MzU1Mg.GbLVgS.L0jVv-TsF-J9-uCmcC05hbRd5kJJxcPhxdjOVI;

// ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
function spinWheel(message) {
  const prizes = ['Ø¬Ø§Ø¦Ø²Ø© 1', 'Ø¬Ø§Ø¦Ø²Ø© 2', 'Ø¬Ø§Ø¦Ø²Ø© 3', 'Ø¬Ø§Ø¦Ø²Ø© 4', 'Ø¬Ø§Ø¦Ø²Ø© 5'];
  const filter = (reaction, user) => {
    return ['ğŸ°'].includes(reaction.emoji.name) && user.id === message.author.id;
  };

  message.reply('Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ğŸ° Ù„ØªØ¯ÙˆØ± Ø§Ù„Ø¹Ø¬Ù„Ø©!').then(sentMessage => {
    sentMessage.react('ğŸ°');
    
    sentMessage.awaitReactions(filter, { max: 1, time: 60000, errors: ['time'] })
      .then(collected => {
        const reaction = collected.first();
        if (reaction.emoji.name === 'ğŸ°') {
          const prize = prizes[Math.floor(Math.random() * prizes.length)];
          message.reply(`Ù„Ù‚Ø¯ ÙØ²Øª Ø¨${prize}!`);
        }
      })
      .catch(() => {
        message.reply('Ù„Ù… ØªÙ‚Ù… Ø¨Ø§Ù„Ø±Ø¯ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!');
      });
  });
}

client.on('ready', () => {
  console.log(`Logged in as ${client.user.tag}!`);
});

client.on('message', async message => {
  if (message.content === '!spin') {
    spinWheel(message);
  }
  // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ù‡Ù†Ø§
});

client.login(TOKEN);
